<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cape Town Property Prices - Interactive Map</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <link rel="stylesheet" href="css/styles.css" />
</head>
<body>
  <div id="map"></div>

  <div id="info-panel" class="info-panel">
    <div class="panel-tabs">
      <button class="panel-tab active" onclick="showTab('info')">Info</button>
      <button class="panel-tab" onclick="showTab('rankings')">Top 5</button>
    </div>

    <div id="tab-info" class="tab-content active">
      <h2>Cape Town Property Prices</h2>
      <p class="instruction">Hover over a neighborhood to see prices</p>
      <div id="price-info"></div>
    </div>

    <div id="tab-rankings" class="tab-content">
      <h2>Investment Rankings</h2>
      <p class="rankings-subtitle">Top 5 neighborhoods by net yield (35m¬≤ apartment)</p>

      <div class="rankings-grid">
        <div class="ranking-card">
          <h4>üè† Long-Term + Resale</h4>
          <ol id="rank-lt-resale" class="ranking-list"></ol>
        </div>

        <div class="ranking-card">
          <h4>üè† Long-Term + New</h4>
          <ol id="rank-lt-new" class="ranking-list"></ol>
        </div>

        <div class="ranking-card">
          <h4>‚úàÔ∏è Airbnb + Resale</h4>
          <ol id="rank-ab-resale" class="ranking-list"></ol>
        </div>

        <div class="ranking-card">
          <h4>‚úàÔ∏è Airbnb + New</h4>
          <ol id="rank-ab-new" class="ranking-list"></ol>
        </div>
      </div>

      <div class="rankings-note">
        <strong>Note:</strong> Net yield includes all costs (levy, rates, insurance, fees, management).
        Airbnb assumes average occupancy - top performers can achieve higher yields.
      </div>
    </div>
  </div>

  <div id="legend" class="legend">
    <h4>Price per m¬≤ (ZAR)</h4>
    <div class="legend-item"><span class="color-box" style="background:#2ECC71"></span><span>R24k - R35k</span></div>
    <div class="legend-item"><span class="color-box" style="background:#F1C40F"></span><span>R35k - R50k</span></div>
    <div class="legend-item"><span class="color-box" style="background:#F39C12"></span><span>R50k - R70k</span></div>
    <div class="legend-item"><span class="color-box" style="background:#E67E22"></span><span>R70k - R100k</span></div>
    <div class="legend-item"><span class="color-box" style="background:#E74C3C"></span><span>R100k - R140k</span></div>
    <div class="legend-item"><span class="color-box" style="background:#8E44AD"></span><span>R140k+</span></div>
  </div>

  <div id="data-source" class="data-source">
    Data: The Africanvestor, Property24, Lightstone, Airbnb (Feb 2026)
  </div>

  <!-- Mini Business Plan Modal -->
  <div id="bp-modal" class="bp-modal">
    <div class="bp-modal-content">
      <button class="bp-close" onclick="closeBPModal()">&times;</button>

      <div class="bp-header">
        <h2 id="bp-title">Business Plan</h2>
        <span id="bp-zone" class="bp-zone-badge"></span>
      </div>

      <div class="bp-inputs">
        <div class="bp-input-group">
          <label for="bp-size">Apartment Size (m¬≤)</label>
          <input type="number" id="bp-size" value="35" min="15" max="200" step="5">
        </div>
        <div class="bp-input-group">
          <label>Purchase Type</label>
          <div class="bp-toggle">
            <button id="btn-resale" class="bp-toggle-btn active" onclick="setPurchaseType('resale')">Resale</button>
            <button id="btn-new" class="bp-toggle-btn" onclick="setPurchaseType('new')">New Dev</button>
          </div>
        </div>
      </div>

      <div class="bp-summary">
        <div class="bp-summary-item">
          <span class="bp-summary-label">Purchase Price</span>
          <span id="bp-purchase-price" class="bp-summary-value">-</span>
        </div>
        <div class="bp-summary-item">
          <span class="bp-summary-label">Price per m¬≤</span>
          <span id="bp-price-sqm" class="bp-summary-value">-</span>
        </div>
      </div>

      <div class="bp-comparison">
        <div class="bp-column bp-longterm">
          <div class="bp-column-header">
            <h3>Long-Term Rental</h3>
            <span class="bp-column-icon">üè†</span>
          </div>
          <div class="bp-metrics">
            <div class="bp-metric">
              <span class="bp-metric-label">Monthly Rent</span>
              <span id="bp-lt-rent" class="bp-metric-value">-</span>
            </div>
            <div class="bp-metric">
              <span class="bp-metric-label">Annual Revenue</span>
              <span id="bp-lt-annual" class="bp-metric-value">-</span>
            </div>
            <div class="bp-metric">
              <span class="bp-metric-label">Occupancy</span>
              <span id="bp-lt-occupancy" class="bp-metric-value">95%</span>
            </div>
            <div class="bp-metric bp-metric-sub">
              <span class="bp-metric-label">Body Corporate</span>
              <span id="bp-lt-levy" class="bp-metric-value expense">-</span>
            </div>
            <div class="bp-metric bp-metric-sub">
              <span class="bp-metric-label">Rates & Taxes</span>
              <span id="bp-lt-rates" class="bp-metric-value expense">-</span>
            </div>
            <div class="bp-metric bp-metric-sub">
              <span class="bp-metric-label">Insurance</span>
              <span id="bp-lt-insurance" class="bp-metric-value expense">-</span>
            </div>
            <div class="bp-metric bp-metric-sub">
              <span class="bp-metric-label">Maintenance (5%)</span>
              <span id="bp-lt-maintenance" class="bp-metric-value expense">-</span>
            </div>
            <div class="bp-metric bp-metric-highlight">
              <span class="bp-metric-label">Net Annual Income</span>
              <span id="bp-lt-net" class="bp-metric-value">-</span>
            </div>
            <div class="bp-metric bp-metric-yield">
              <span class="bp-metric-label">Gross Yield</span>
              <span id="bp-lt-gross-yield" class="bp-metric-value">-</span>
            </div>
            <div class="bp-metric bp-metric-yield">
              <span class="bp-metric-label">Net Yield</span>
              <span id="bp-lt-net-yield" class="bp-metric-value highlight">-</span>
            </div>
          </div>
        </div>

        <div class="bp-column bp-airbnb">
          <div class="bp-column-header">
            <h3>Airbnb</h3>
            <span class="bp-column-icon">‚úàÔ∏è</span>
          </div>
          <div class="bp-metrics">
            <div class="bp-metric">
              <span class="bp-metric-label">Nightly Rate</span>
              <span id="bp-ab-nightly" class="bp-metric-value">-</span>
            </div>
            <div class="bp-metric">
              <span class="bp-metric-label">Annual Revenue</span>
              <span id="bp-ab-annual" class="bp-metric-value">-</span>
            </div>
            <div class="bp-metric">
              <span class="bp-metric-label">Occupancy</span>
              <span id="bp-ab-occupancy" class="bp-metric-value">-</span>
            </div>
            <div class="bp-metric bp-metric-sub">
              <span class="bp-metric-label">Airbnb Fees (15%)</span>
              <span id="bp-ab-fees" class="bp-metric-value expense">-</span>
            </div>
            <div class="bp-metric bp-metric-sub">
              <span class="bp-metric-label">Cleaning (R400/turn)</span>
              <span id="bp-ab-cleaning" class="bp-metric-value expense">-</span>
            </div>
            <div class="bp-metric bp-metric-sub">
              <span class="bp-metric-label">Utilities & Supplies</span>
              <span id="bp-ab-utilities" class="bp-metric-value expense">-</span>
            </div>
            <div class="bp-metric bp-metric-sub">
              <span class="bp-metric-label">Management (20%)</span>
              <span id="bp-ab-management" class="bp-metric-value expense">-</span>
            </div>
            <div class="bp-metric bp-metric-highlight">
              <span class="bp-metric-label">Net Annual Income</span>
              <span id="bp-ab-net" class="bp-metric-value">-</span>
            </div>
            <div class="bp-metric bp-metric-yield">
              <span class="bp-metric-label">Gross Yield</span>
              <span id="bp-ab-gross-yield" class="bp-metric-value">-</span>
            </div>
            <div class="bp-metric bp-metric-yield">
              <span class="bp-metric-label">Net Yield</span>
              <span id="bp-ab-net-yield" class="bp-metric-value highlight">-</span>
            </div>
          </div>
        </div>
      </div>

      <div class="bp-verdict">
        <h4>Recommendation</h4>
        <p id="bp-recommendation">-</p>
      </div>

      <div class="bp-section-divider"></div>

      <div class="bp-projection">
        <h3>10-Year Projection</h3>

        <div class="bp-projection-inputs">
          <div class="bp-input-group">
            <label for="bp-appreciation">Annual Appreciation (%)</label>
            <input type="number" id="bp-appreciation" value="5" min="0" max="15" step="0.5">
          </div>
          <div class="bp-input-group">
            <label for="bp-rent-increase">Annual Rent Increase (%)</label>
            <input type="number" id="bp-rent-increase" value="6" min="0" max="15" step="0.5">
          </div>
        </div>

        <div class="bp-chart-container">
          <canvas id="bp-chart"></canvas>
        </div>

        <div class="bp-breakeven">
          <div class="bp-breakeven-item">
            <span class="bp-breakeven-label">Break-even (Long-Term)</span>
            <span id="bp-breakeven-lt" class="bp-breakeven-value">-</span>
          </div>
          <div class="bp-breakeven-item">
            <span class="bp-breakeven-label">Break-even (Airbnb)</span>
            <span id="bp-breakeven-ab" class="bp-breakeven-value">-</span>
          </div>
        </div>

        <div class="bp-projection-summary">
          <h4>After 10 Years</h4>
          <div class="bp-projection-grid">
            <div class="bp-projection-card lt">
              <span class="bp-projection-label">Long-Term Total Profit</span>
              <span id="bp-10y-lt-profit" class="bp-projection-value">-</span>
            </div>
            <div class="bp-projection-card ab">
              <span class="bp-projection-label">Airbnb Total Profit</span>
              <span id="bp-10y-ab-profit" class="bp-projection-value">-</span>
            </div>
          </div>
        </div>
      </div>

      <div class="bp-section-divider"></div>

      <div class="bp-taxes">
        <h3>All Taxes & Fees (Non-Resident)</h3>

        <div class="bp-taxes-section">
          <h4>Acquisition Costs (One-Time)</h4>
          <div class="bp-tax-item">
            <span>Transfer Duty</span>
            <span id="bp-tax-transfer">-</span>
          </div>
          <div class="bp-tax-item">
            <span>Conveyancing & Deeds</span>
            <span id="bp-tax-convey">~R45,000</span>
          </div>
          <div class="bp-tax-item total">
            <span>Total Acquisition</span>
            <span id="bp-tax-acq-total">-</span>
          </div>
        </div>

        <div class="bp-taxes-section">
          <h4>Annual Taxes</h4>
          <div class="bp-tax-item">
            <span>Municipal Rates (0.72%)</span>
            <span id="bp-tax-rates">-</span>
          </div>
          <div class="bp-tax-item">
            <span>Rental Income Tax (~25% effective)</span>
            <span id="bp-tax-income">-</span>
          </div>
        </div>

        <div class="bp-taxes-section">
          <h4>Sale Costs (If Selling After 10Y)</h4>
          <div class="bp-tax-item">
            <span>Agent Commission (7%+VAT)</span>
            <span id="bp-tax-agent">-</span>
          </div>
          <div class="bp-tax-item">
            <span>CGT (~18% on gain)</span>
            <span id="bp-tax-cgt">-</span>
          </div>
          <div class="bp-tax-item">
            <span>Non-Resident Withholding (7.5%)</span>
            <span id="bp-tax-withhold">-</span>
          </div>
        </div>

        <div class="bp-taxes-note">
          <strong>France-SA Tax Treaty:</strong> Rental income taxed in SA first.
          Credit available against French taxes to avoid double taxation.
          Consult a cross-border tax advisor for your specific situation.
        </div>
      </div>

      <div class="bp-footer">
        <small>Estimates based on market data. Actual results may vary. Consult a tax professional.</small>
      </div>
    </div>
  </div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
